import{a as r}from"./chunk-TMI4QPZX-ByyJG4wn.js";import{u as k,C as h}from"./index-CLcShtRP.js";const I=e=>{const f=k(o=>o.user.passwordGuessed),[S,m]=r.useState(null),[T,E]=r.useState(null),[F,i]=r.useState(!1),[P,D]=r.useState(!1),[g,w]=r.useState(null),[u,L]=r.useState(!1),c=e&&"password"in e?e.password:S,n=e&&"dropDateTime"in e?e.dropDateTime:T;r.useEffect(()=>{if(!!(e&&"password"in e))return;let t=!1;return i(!0),new h().getNextDropPassword().then(s=>{t||m(s.password??null)}).catch(()=>{t||w("Failed to fetch drop password")}).finally(()=>{t||i(!1)}),()=>{t=!0}},[e]),r.useEffect(()=>{if(!!(e&&"dropDateTime"in e))return;let t=!1;return D(!0),new h().getNextDrop().then(s=>{t||E((s==null?void 0:s.dateTime)??null)}).catch(()=>{t||w("Failed to fetch drop data")}).finally(()=>{t||D(!1)}),()=>{t=!0}},[e]);const d=r.useMemo(()=>n?new Date(n):null,[n]);return r.useEffect(()=>{if(!d)return;const o=d.getTime(),t=a=>a>24*60*60*1e3?15*60*1e3:a>6*60*60*1e3?5*60*1e3:a>60*60*1e3?60*1e3:a>10*60*1e3?5*1e3:a>60*1e3?1*1e3:500;let s=null;const p=()=>{const a=Date.now(),l=o-a;L(l>0),!(l<=0)&&(s=setTimeout(p,t(l)))};return p(),()=>{s&&clearTimeout(s)}},[d]),{isDropLocked:r.useMemo(()=>!!u&&c!==null&&f!==c,[u,c,f]),isInFuture:u,loading:F||P,error:g}},_={SET_PASSWORD_GUESSED:"SET_PASSWORD_GUESSED"};export{_ as a,I as u};
